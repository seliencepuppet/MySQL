
### 存储过程的介绍

存储过程是一组为了完成特定功能的SQL语句集, 经编译后存储在数据库中. 用户通过指定存储过程的名字并给出参数(如果该存储过程带有参数)来执行. 存储过程可由应用程序通过一个调用来执行, 而且允许用户生命变量. 同时, 存储过程可以接收和输出参数, 返回执行存储过程的状态值, 也可以嵌套调用.

### 存储过程和函数的区别

函数往往作为公式进行使用, 存储过程作为完成某种功能进行使用.

函数分为表值函数跟标量函数. 表值函数是经过一些sql语句方法最后返回一个值.

函数可以在select语句中直接使用，而过程不能.

### 存储过程的优点

1) 减少网络通信量，调用一个行数不多的存储过程与直接调用SQL语句的网络通信量可能不会有很大的差别, 可是如果存储过程包含上百行SQL语句，那么其性能绝对比一条一条的调用SQL语句要高的多.
2) 执行速度更快, 存储过程创建的时候，数据库已经对其进行了一次解析和优化。其次, 存储过程一旦执行，在内存中就会保留一份这个存储过程，这样下次再执行同样的存储过程时，可以从内存中直接读取
3) 更强的安全性, 存储过程是通过向用户授予权限(而不是基于表), 它们可以提供对特定数据的访问，提高代码安全，比如防止SQL注入
4) 业务逻辑可以封装在存储过程当中，这样不仅容易维护，而且执行效率也高

### 当然存储过程也有一些缺点

1) 可移植性方面：当从一种数据库迁移到另外一种数据库时，不少的存储过程的编写要进行部分修改
2）存储过程需要花费一定的学习时间去学习，比如学习其中的语法

### 定义存储过程的结束符

在存储过程中，通常要输入很多SQL语句，而SQL语句中每个语句以分号来结束，因此要告诉存储过程，什么位置是意味着整个存储过程结束，所以在编写存储过程之前，先定义分隔符，这里定义为 // 为分隔符，使用 DELIMITER // 这样的语法，就可以定义结束符号了。

```sql
DELIMITER // 生命语句结束符，用于区分
CREATE PROCEDURE demo_in_parameter(p_in int) // 声明存储过程
BEGIN ... END
SET @p_in=1变量赋值
DECLARE I_int int unsigned default 4000000; // 变量定义
```

例如，创建一个简单的存储过程

```sql
CREATE DEFINER=`test`@`%` PROCEDURE `addstudent`(pname varchar(32), page int(11), pscore int(11)) 
BEGIN
    insert into t_student(name, age, score) values (pname, page, pscore);
END
```
